name: Create submodule PR
description: Opens a PR in a submodule repository.
author: Marissa Ovenshire

inputs:
  repo:
    description: 'Owner/repo of the submodule'
    required: true
  head:
    description: 'Branch name that contains the changes (source)'
    required: true
  base:
    description: 'Target branch name in the submodule'
    required: true
  token:
    description: 'GitHub token (GH_TOKEN) with repo write permission'
    required: true

runs:
  using: "composite"
  steps:
    - name: Open PR via gh API
      env:
        GH_TOKEN: ${{ inputs.token }}
        SUB_REPO: ${{ inputs.repo }}
        MATCH_BRANCH: ${{ inputs.head }}
        BASE_BRANCH: ${{ inputs.base }}
      shell: bash
      run: |
        TITLE="chore(submod): sync ${MATCH_BRANCH} → ${BASE_BRANCH}"
        BODY="Auto‑generated PR to merge **${MATCH_BRANCH}** into **${BASE_BRANCH}** for submodule **${SUB_REPO}**.\n\nGenerated by the *Create Submodule PRs* workflow."
        gh api -X POST repos/${SUB_REPO}/pulls \
          -f title="${TITLE}" \
          -f head="${MATCH_BRANCH}" \
          -f base="${BASE_BRANCH}" \
          -f body="${BODY}"